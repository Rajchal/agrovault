<!doctype html>
<html lang="ne">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="mobile-web-app-capable" content="yes"/>
<title>KisanCool â€” Smart Agricultural Dashboard</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
:root{
  --bg:#f0f2f5;--card:#ffffff;--text:#111827;--muted:#6b7280;
  --good:#059669;--goodBg:#ecfdf5;--goodBd:#a7f3d0;
  --warn:#d97706;--warnBg:#fffbeb;--warnBd:#fde68a;
  --bad:#dc2626;--badBg:#fef2f2;--badBd:#fecaca;
  --accent:#2563eb;--accentBg:#eff6ff;--accentBd:#bfdbfe;
  --border:#e5e7eb;
  --shadow:0 1px 3px rgba(0,0,0,.06);
  --shadowLg:0 4px 20px rgba(0,0,0,.08);
  --radius:16px;
  --sans:'Inter',system-ui,-apple-system,sans-serif;
  --mono:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;
  --bottomNav:68px;
}
*{box-sizing:border-box;margin:0;padding:0}
html{overflow-x:hidden}
body{background:var(--bg);color:var(--text);font-family:var(--sans);font-size:16px;line-height:1.6;-webkit-font-smoothing:antialiased;padding-bottom:calc(var(--bottomNav) + 16px)}
::-webkit-scrollbar{width:4px}::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:99px}

/* â”€â”€ Top Nav â”€â”€ */
nav{
  background:rgba(255,255,255,.96);border-bottom:1px solid var(--border);
  padding:8px 12px;display:flex;align-items:center;justify-content:space-between;
  position:sticky;top:0;z-index:100;backdrop-filter:blur(12px);gap:6px;
  height:48px;
}
.nav-left{display:flex;align-items:center;gap:8px;min-width:0;flex:1}
.logo{
  width:32px;height:32px;border-radius:10px;flex-shrink:0;
  background:linear-gradient(135deg,#059669,#2563eb);
  display:flex;align-items:center;justify-content:center;
  color:#fff;font-size:16px;box-shadow:0 2px 6px rgba(37,99,235,.2);
}
.brand h1{font-size:16px;font-weight:900;letter-spacing:-.3px;line-height:1}
.brand .tagline{display:none}
.nav-right{display:flex;align-items:center;gap:6px;flex-shrink:0}
.nav-meta{
  display:flex;align-items:center;gap:4px;
  padding:4px 8px;background:#f8fafc;border:1px solid var(--border);border-radius:999px;
  font-size:11px;color:var(--muted);font-weight:600;
}
.status-dot{width:7px;height:7px;border-radius:50%;background:var(--good);box-shadow:0 0 0 2px rgba(5,150,105,.2);animation:pulse 2s infinite;flex-shrink:0}
@keyframes pulse{0%,100%{box-shadow:0 0 0 2px rgba(5,150,105,.2)}50%{box-shadow:0 0 0 5px rgba(5,150,105,.1)}}
.lang-toggle{
  display:flex;background:#f1f5f9;border:1px solid var(--border);border-radius:999px;
  padding:2px;cursor:pointer;user-select:none;flex-shrink:0;
}
.lang-toggle span{
  padding:4px 10px;border-radius:999px;font-size:11px;font-weight:700;
  transition:all .25s;color:var(--muted);
}
.lang-toggle span.active{background:#fff;color:var(--text);box-shadow:0 1px 3px rgba(0,0,0,.1)}
@media(min-width:600px){
  nav{padding:10px 20px;height:56px}
  .logo{width:38px;height:38px;font-size:18px}
  .brand h1{font-size:18px}
  .brand .tagline{display:block;font-size:11px;color:var(--muted);font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:200px}
  .nav-meta{font-size:12px;padding:5px 10px}
  .lang-toggle span{padding:5px 12px;font-size:12px}
}

/* â”€â”€ Main Content â”€â”€ */
main{max-width:640px;margin:0 auto;padding:12px 12px 20px}
@media(min-width:768px){main{max-width:800px;padding:20px 24px 40px}}

/* â”€â”€ Page Sections (tabs) â”€â”€ */
.page{display:none}
.page.active{display:block}

.section-header{display:flex;align-items:center;gap:8px;margin:20px 0 12px;flex-wrap:wrap}
.section-header:first-child{margin-top:4px}
.section-header h2{font-size:19px;font-weight:900;letter-spacing:-.3px}
.section-badge{padding:3px 12px;border-radius:999px;font-size:12px;font-weight:700;background:var(--accentBg);color:var(--accent);border:1px solid var(--accentBd)}

/* â”€â”€ KPIs â”€â”€ */
.kpi-row{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:12px}
.kpi{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:16px;box-shadow:var(--shadow);transition:box-shadow .2s}
.kpi .label{font-size:13px;color:var(--muted);margin-bottom:4px;font-weight:600;display:flex;align-items:center;gap:6px}
.kpi .emoji{font-size:18px}
.kpi .value{font-size:32px;font-weight:900;letter-spacing:-1px;line-height:1.1}
@media(min-width:400px){.kpi .value{font-size:36px}}
.kpi .sub{font-size:12px;color:var(--muted);margin-top:6px;font-weight:500}
.tag{display:inline-flex;padding:3px 10px;border-radius:999px;font-size:12px;font-weight:700;margin-top:6px}
.tag.ok{background:var(--goodBg);color:var(--good);border:1px solid var(--goodBd)}
.tag.warning{background:var(--warnBg);color:var(--warn);border:1px solid var(--warnBd)}
.tag.danger{background:var(--badBg);color:var(--bad);border:1px solid var(--badBd)}
.tag.info{background:var(--accentBg);color:var(--accent);border:1px solid var(--accentBd)}

/* â”€â”€ Cards â”€â”€ */
.card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden;margin-bottom:12px}
.card-head{padding:14px 16px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;gap:8px}
.card-head h3{font-size:16px;font-weight:800;display:flex;align-items:center;gap:6px}
.card-body{padding:16px}
canvas{width:100%;height:200px;display:block}

/* â”€â”€ Controls â”€â”€ */
.field-group{display:flex;flex-direction:column;gap:10px}
.field{background:#f8fafc;border:1px solid var(--border);border-radius:14px;padding:14px}
.field label{font-size:13px;color:var(--muted);display:flex;align-items:center;justify-content:space-between;margin-bottom:6px;font-weight:600}
.field .fv{font-family:var(--mono);font-size:13px;color:var(--accent);font-weight:700}
select{width:100%;padding:10px 12px;border:1px solid var(--border);border-radius:12px;background:#fff;color:var(--text);font-size:15px;font-weight:600;outline:none;font-family:var(--sans);cursor:pointer;-webkit-appearance:none}
select:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(37,99,235,.1)}
input[type=range]{width:100%;accent-color:var(--accent);height:6px}

/* â”€â”€ Multi-select Crop Chips â”€â”€ */
.crop-chips{display:flex;flex-wrap:wrap;gap:8px;margin-top:4px}
.crop-chip{
  display:inline-flex;align-items:center;gap:6px;
  padding:10px 14px;border-radius:999px;font-size:14px;font-weight:700;
  border:2px solid var(--border);background:#fff;
  cursor:pointer;user-select:none;transition:all .2s;
  -webkit-tap-highlight-color:transparent;
}
.crop-chip:active{transform:scale(.96)}
.crop-chip.selected{background:var(--accentBg);border-color:var(--accent);color:var(--accent)}
.crop-chip .chip-emoji{font-size:18px}
.crop-chip .chip-check{width:18px;height:18px;border-radius:50%;border:2px solid var(--border);display:flex;align-items:center;justify-content:center;font-size:10px;color:#fff;transition:all .2s;flex-shrink:0}
.crop-chip.selected .chip-check{background:var(--accent);border-color:var(--accent)}

/* â”€â”€ Compromise Warning â”€â”€ */
.compromise-banner{
  padding:12px 14px;border-radius:12px;margin-top:10px;
  font-size:13px;font-weight:600;line-height:1.5;
  display:flex;align-items:flex-start;gap:8px;
}
.compromise-banner.ideal{background:var(--goodBg);border:1px solid var(--goodBd);color:#065f46}
.compromise-banner.compromised{background:var(--warnBg);border:1px solid var(--warnBd);color:#92400e}
.compromise-banner .cb-icon{font-size:16px;flex-shrink:0;margin-top:1px}

/* â”€â”€ Toggle / Switch â”€â”€ */
.toggle-row{display:flex;align-items:center;justify-content:space-between;padding:14px;background:#f8fafc;border:1px solid var(--border);border-radius:14px}
.toggle-info .t{font-size:14px;font-weight:700}
.toggle-info .d{font-size:13px;color:var(--muted);font-weight:500}
.sw{width:48px;height:26px;border-radius:999px;background:#d1d5db;position:relative;cursor:pointer;transition:background .25s;flex-shrink:0;-webkit-tap-highlight-color:transparent}
.sw::after{content:"";position:absolute;top:3px;left:3px;width:20px;height:20px;border-radius:50%;background:#fff;transition:transform .25s;box-shadow:0 2px 6px rgba(0,0,0,.2)}
.sw.on{background:var(--good)}.sw.on::after{transform:translateX(22px)}

/* â”€â”€ Alerts â”€â”€ */
.alert-item{padding:12px 14px;border-radius:14px;margin-bottom:8px;display:flex;align-items:flex-start;gap:10px;font-size:13px}
.alert-item.ok{background:var(--goodBg);border:1px solid var(--goodBd)}
.alert-item.warning{background:var(--warnBg);border:1px solid var(--warnBd)}
.alert-item.danger{background:var(--badBg);border:1px solid var(--badBd)}
.alert-icon{width:26px;height:26px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-weight:900;font-size:13px;flex-shrink:0}
.alert-item.ok .alert-icon{background:#d1fae5;color:var(--good)}
.alert-item.warning .alert-icon{background:#fef3c7;color:var(--warn)}
.alert-item.danger .alert-icon{background:#fee2e2;color:var(--bad)}
.alert-text .ah{font-weight:700;font-size:14px}
.alert-text .ad{color:var(--muted);margin-top:2px;font-size:13px;line-height:1.5}

/* â”€â”€ Weather â”€â”€ */
.wx-main{font-size:26px;font-weight:900;letter-spacing:-.5px}
.wx-detail{font-size:14px;color:var(--muted);margin-top:4px;font-weight:500}
.wx-advice{margin-top:12px;padding:12px 14px;background:var(--accentBg);border:1px solid var(--accentBd);border-radius:14px;font-size:14px;color:#1e40af;font-weight:500;line-height:1.5}
.forecast-strip{display:flex;gap:6px;overflow-x:auto;padding-bottom:4px;-webkit-overflow-scrolling:touch;scroll-snap-type:x mandatory}
.forecast-day{text-align:center;padding:12px 8px;border-radius:14px;background:#f8fafc;border:1px solid var(--border);min-width:65px;flex-shrink:0;scroll-snap-align:start}
.forecast-day .fd-icon{font-size:24px}
.forecast-day .fd-temp{font-size:15px;font-weight:800;margin-top:2px}
.forecast-day .fd-label{font-size:11px;color:var(--muted);font-weight:600}

/* â”€â”€ Shelf Life â”€â”€ */
.shelf-item{display:flex;align-items:center;justify-content:space-between;gap:10px;padding:10px 0;border-bottom:1px solid var(--border)}
.shelf-item:last-child{border-bottom:none}
.shelf-name{font-weight:700;font-size:15px}
.shelf-days{font-size:13px;color:var(--muted);font-weight:600;white-space:nowrap}
.shelf-bar{width:100px;height:7px;background:#e5e7eb;border-radius:999px;overflow:hidden;flex-shrink:0}
.shelf-bar .fill{height:100%;border-radius:999px;transition:width .5s}

/* â”€â”€ Grid Layouts for Info Page â”€â”€ */
.info-grid{display:grid;grid-template-columns:1fr;gap:12px}
@media(min-width:600px){.info-grid-2{grid-template-columns:1fr 1fr}}

.info-card{padding:18px;border-radius:16px;border:1px solid var(--border);background:#f8fafc;transition:background .2s}
.info-card:active{background:#fff}
.info-card .ic-emoji{font-size:32px;margin-bottom:8px}
.info-card .ic-title{font-size:16px;font-weight:800;margin-bottom:4px}
.info-card .ic-desc{font-size:14px;color:var(--muted);line-height:1.5;font-weight:500}
.ic-list{list-style:none;padding:0;margin-top:10px}
.ic-list li{padding:6px 0;border-bottom:1px solid var(--border);font-size:14px;font-weight:500;display:flex;align-items:flex-start;gap:6px}
.ic-list li:last-child{border-bottom:none}
.ic-list li::before{content:"â†’";color:var(--accent);font-weight:700;flex-shrink:0}

/* â”€â”€ Market Prices â”€â”€ */
.price-card{padding:14px;border-radius:14px;border:1px solid var(--border);background:#fff;display:flex;align-items:center;gap:12px}
.price-card .pc-emoji{font-size:28px;flex-shrink:0}
.price-card .pc-info{flex:1;min-width:0}
.price-card .pc-name{font-size:15px;font-weight:800}
.price-card .pc-price{font-size:14px;color:var(--muted);font-weight:600}
.price-card .pc-right{text-align:right;flex-shrink:0}
.price-card .pc-change{font-size:15px;font-weight:800}
.price-card .pc-advice{font-size:11px;color:var(--muted);font-weight:500;max-width:120px}
.trend-up{color:var(--good)}.trend-down{color:var(--bad)}.trend-flat{color:var(--warn)}

/* â”€â”€ Season Calendar â”€â”€ */
.season-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
@media(min-width:500px){.season-grid{grid-template-columns:repeat(4,1fr)}}
.season-item{padding:14px;border-radius:14px;text-align:center;border:1px solid var(--border)}
.season-item .s-emoji{font-size:28px;display:block;margin-bottom:4px}
.season-item .s-name{font-size:14px;font-weight:800}
.season-item .s-months{font-size:12px;color:var(--muted);font-weight:500;margin-top:2px}
.season-item.in-season{background:var(--goodBg);border-color:var(--goodBd)}
.season-item.off-season{background:#f8fafc}

/* â”€â”€ Disease Cards â”€â”€ */
.disease-card{padding:16px;border-radius:16px;border:1px solid var(--border);background:#fff}
.disease-card .d-header{display:flex;align-items:center;gap:8px;margin-bottom:8px;flex-wrap:wrap}
.disease-card .d-name{font-size:16px;font-weight:800}
.disease-card .d-crop{font-size:13px;color:var(--muted);font-weight:600}
.d-risk{padding:3px 10px;border-radius:999px;font-size:11px;font-weight:700}
.d-risk.high{background:var(--badBg);color:var(--bad);border:1px solid var(--badBd)}
.d-risk.medium{background:var(--warnBg);color:var(--warn);border:1px solid var(--warnBd)}
.d-risk.low{background:var(--goodBg);color:var(--good);border:1px solid var(--goodBd)}
.disease-card .d-body{font-size:14px;color:var(--muted);line-height:1.5;font-weight:500;margin-bottom:10px}
.disease-card .d-action{padding:12px;border-radius:12px;background:#f0fdf4;border:1px solid #bbf7d0;font-size:13px;color:#065f46;font-weight:600;line-height:1.5}

.empty-note{font-size:14px;color:var(--muted);padding:10px 0;font-weight:500}

/* â”€â”€ Bottom Tab Nav â”€â”€ */
.bottom-nav{
  position:fixed;bottom:0;left:0;right:0;
  height:var(--bottomNav);
  background:rgba(255,255,255,.97);
  border-top:1px solid var(--border);
  backdrop-filter:blur(14px);
  display:flex;align-items:stretch;justify-content:space-around;
  z-index:200;
  padding-bottom:env(safe-area-inset-bottom,0);
}
.bottom-nav .tab{
  flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;
  gap:3px;cursor:pointer;user-select:none;color:var(--muted);
  font-size:11px;font-weight:600;transition:color .2s;
  -webkit-tap-highlight-color:transparent;position:relative;
}
.bottom-nav .tab.active{color:var(--accent)}
.bottom-nav .tab.active::before{
  content:"";position:absolute;top:0;left:50%;transform:translateX(-50%);
  width:32px;height:3px;background:var(--accent);border-radius:0 0 4px 4px;
}
.bottom-nav .tab-icon{font-size:22px;line-height:1}
.bottom-nav .tab-label{white-space:nowrap}

/* â”€â”€ Utility â”€â”€ */
.mt-12{margin-top:12px}
.mb-8{margin-bottom:8px}
</style>
</head>
<body>

<!-- â”€â”€ Top Navigation â”€â”€ -->
<nav>
  <div class="nav-left">
    <div class="logo">ğŸŒ±</div>
    <div class="brand">
      <h1 id="navTitle">KisanCool</h1>
      <div class="tagline" id="navTagline">Smart Agricultural Cold Storage</div>
    </div>
  </div>
  <div class="nav-right">
    <div class="lang-toggle" id="langToggle">
      <span data-lang="en">EN</span>
      <span class="active" data-lang="ne">à¤¨à¥‡</span>
    </div>
    <div class="nav-meta">
      <span class="status-dot"></span>
      <span id="clockLabel"></span>
    </div>
  </div>
</nav>

<!-- â•â•â•â•â•â•â•â•â•â•â• PAGE 1: MONITOR â•â•â•â•â•â•â•â•â•â•â• -->
<main>
<div class="page active" id="pageMonitor">
  <div class="section-header" style="margin-top:4px"><h2 id="secMonitor">â„ï¸ Cold Storage Monitor</h2><span class="section-badge" id="unitBadge">Unit #1 â€” Active</span></div>

  <div class="kpi-row">
    <div class="kpi"><div class="label"><span class="emoji">ğŸŒ¡ï¸</span><span id="kpiTempLabel">Temperature</span></div><div class="value" id="kpiTemp">â€”</div><div class="sub" id="kpiTempSub"></div><div class="tag ok" id="kpiTempTag">Normal</div></div>
    <div class="kpi"><div class="label"><span class="emoji">ğŸ’§</span><span id="kpiHumLabel">Humidity</span></div><div class="value" id="kpiHum">â€”</div><div class="sub" id="kpiHumSub"></div><div class="tag ok" id="kpiHumTag">Normal</div></div>
    <div class="kpi"><div class="label"><span class="emoji">ğŸ”‹</span><span id="kpiBatLabel">Battery</span></div><div class="value" id="kpiBat">â€”</div><div class="sub" id="kpiBatSub"></div><div class="tag ok" id="kpiBatTag">Good</div></div>
    <div class="kpi"><div class="label"><span class="emoji">âš™ï¸</span><span id="kpiCompLabel">Compressor</span></div><div class="value" id="kpiComp">â€”</div><div class="sub" id="kpiCompSub"></div><div class="tag ok" id="kpiCompTag">Auto</div></div>
  </div>

  <!-- Chart -->
  <div class="card"><div class="card-head"><h3 id="chartTitle">ğŸ“ˆ Temperature & Humidity</h3></div><div class="card-body"><canvas id="chart"></canvas></div></div>

  <!-- Controls -->
  <div class="card"><div class="card-head"><h3 id="ctrlTitle">ğŸ›ï¸ Controls</h3></div>
    <div class="card-body field-group">
      <div class="field"><label><span id="modeLabel">Operating Mode</span><span class="fv" id="modeHint">AUTO</span></label><select id="modeSelect"><option value="AUTO">Auto</option><option value="ECO">Eco</option><option value="PRECOOL">Pre-Cool</option><option value="MANUAL">Manual</option></select></div>

      <!-- Multi-Crop Selector -->
      <div class="field">
        <label><span id="produceLabel">Produce in Storage</span><span class="fv" id="profileHint">â€”</span></label>
        <div class="crop-chips" id="cropChips"></div>
        <div id="compromiseBanner"></div>
      </div>

      <div class="field" id="manualTempField" style="display:none"><label><span id="mtLabel">Temp Setpoint (Â°C)</span><span class="fv" id="mtVal">6.0</span></label><input id="manualTemp" type="range" min="0" max="15" step="0.5" value="6"/></div>
      <div class="field" id="manualHumField" style="display:none"><label><span id="mhLabel">Humidity Target (%)</span><span class="fv" id="mhVal">90</span></label><input id="manualHum" type="range" min="50" max="98" step="1" value="90"/></div>
      <div class="toggle-row"><div class="toggle-info"><div class="t" id="doorLabel">Door Sensor</div><div class="d" id="doorDesc">Closed</div></div><div class="sw" id="doorSw" role="button"></div></div>
      <div class="toggle-row"><div class="toggle-info"><div class="t" id="gridLabel">Grid Power</div><div class="d" id="gridDesc">Available</div></div><div class="sw on" id="gridSw" role="button"></div></div>
    </div>
  </div>

  <!-- Shelf Life -->
  <div class="card"><div class="card-head"><h3 id="shelfTitle">ğŸ“¦ Estimated Shelf Life</h3></div><div class="card-body" id="shelfBody"></div></div>

  <!-- Alerts -->
  <div class="card"><div class="card-head"><h3 id="alertTitle">ğŸ”” Alerts</h3><span style="font-size:13px;color:var(--muted);font-weight:700" id="alertCount">0</span></div><div class="card-body" id="alertsBody"></div></div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â• PAGE 2: WEATHER & MARKET â•â•â•â•â•â•â•â•â•â•â• -->
<div class="page" id="pageWeather">
  <div class="section-header" style="margin-top:4px"><h2 id="secWeather">ğŸŒ¤ï¸ Weather & Advisory</h2></div>
  <div class="card">
    <div class="card-head"><h3 id="wxLabel">Current Weather</h3></div>
    <div class="card-body">
      <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:10px">
        <div><div class="wx-main" id="wxSummary">â€”</div><div class="wx-detail" id="wxDetail">â€”</div></div>
        <div class="tag warning" id="wxTag" style="font-size:13px;padding:5px 14px">â€”</div>
      </div>
      <div class="wx-advice" id="wxAdvice">â€”</div>
    </div>
  </div>
  <div class="card"><div class="card-head"><h3 id="fcTitle">ğŸ“… 7-Day Forecast</h3></div><div class="card-body"><div class="forecast-strip" id="fcBody"></div></div></div>

  <div class="section-header"><h2 id="secMarket">ğŸ’° Market Prices</h2><span class="section-badge" id="mktBadge">Updated today</span></div>
  <div class="info-grid" id="priceGrid"></div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â• PAGE 3: INFO CENTER â•â•â•â•â•â•â•â•â•â•â• -->
<div class="page" id="pageInfo">
  <div class="section-header" style="margin-top:4px"><h2 id="secGuide">ğŸŒ¾ Crop Knowledge Center</h2></div>
  <div class="info-grid" id="guideGrid"></div>

  <div class="section-header"><h2 id="secDisease">ğŸ¦  Disease & Pest Watch</h2><span class="section-badge" style="background:var(--warnBg);color:var(--warn);border-color:var(--warnBd)" id="disBadge">2 Active Alerts</span></div>
  <div class="info-grid" id="diseaseGrid"></div>

  <div class="section-header"><h2 id="secSeason">ğŸ—“ï¸ Seasonal Planting Calendar</h2></div>
  <div class="card"><div class="card-body"><div class="season-grid" id="seasonGrid"></div></div></div>

  <div class="section-header"><h2 id="secTips">ğŸ’¡ Smart Farming Tips</h2></div>
  <div class="info-grid" id="tipsGrid"></div>
</div>
</main>

<!-- â”€â”€ Bottom Tab Navigation â”€â”€ -->
<div class="bottom-nav" id="bottomNav">
  <div class="tab active" data-page="pageMonitor">
    <span class="tab-icon">â„ï¸</span>
    <span class="tab-label" id="tabMonitor">Monitor</span>
  </div>
  <div class="tab" data-page="pageWeather">
    <span class="tab-icon">ğŸŒ¤ï¸</span>
    <span class="tab-label" id="tabWeather">Weather</span>
  </div>
  <div class="tab" data-page="pageInfo">
    <span class="tab-icon">ğŸ“š</span>
    <span class="tab-label" id="tabInfo">Info</span>
  </div>
</div>

<script>
const $=id=>document.getElementById(id);
function clamp(x,a,b){return Math.max(a,Math.min(b,x))}
function rnd(n){return(Math.random()*2-1)*n}

/* â•â•â•â•â•â•â•â•â•â•â•â• i18n â•â•â•â•â•â•â•â•â•â•â•â• */
const L={
en:{
  navTitle:"KisanCool",tagline:"Smart Agricultural Cold Storage",connected:"Connected",
  temp:"Temperature",hum:"Humidity",bat:"Battery",comp:"Compressor",
  normal:"Normal",good:"Good",low:"Low",critical:"Critical",high:"High",
  auto:"Auto",on:"ON",off:"OFF",tgt:"Target",solar:"Solar",
  chartTitle:"ğŸ“ˆ Temperature & Humidity",shelfTitle:"ğŸ“¦ Estimated Shelf Life",
  ctrlTitle:"ğŸ›ï¸ Controls",modeLabel:"Operating Mode",produceLabel:"Produce in Storage",
  mtLabel:"Temp Setpoint (Â°C)",mhLabel:"Humidity Target (%)",
  doorLabel:"Door Sensor",doorClosed:"Closed",doorOpen:"Open â€” cooling paused",
  gridLabel:"Grid Power",gridOn:"Available",gridOff:"Unavailable â€” off-grid",
  alertTitle:"ğŸ”” Alerts",noAlerts:"No alerts. All systems normal.",
  rem:"remaining",days:"days",
  unitBadge:"Unit #1 â€” Active",mktBadge:"Updated today",disBadge:"2 Active Alerts",
  secMonitor:"â„ï¸ Cold Storage Monitor",secWeather:"ğŸŒ¤ï¸ Weather & Advisory",
  secMarket:"ğŸ’° Market Prices",secGuide:"ğŸŒ¾ Crop Knowledge Center",
  secDisease:"ğŸ¦  Disease & Pest Watch",secSeason:"ğŸ—“ï¸ Seasonal Planting Calendar",secTips:"ğŸ’¡ Smart Farming Tips",
  wxLabel:"Current Weather",fcTitle:"ğŸ“… 7-Day Forecast",
  tabMonitor:"Monitor",tabWeather:"Weather",tabInfo:"Info",
  selectCrops:"Tap to select crops stored",
  TOMATO:"Tomato",ONION:"Onion",POTATO:"Potato",LEAFY_GREENS:"Leafy Greens",CARROT:"Carrot",
  idealRange:"All crops share an ideal temperature range",
  compromiseRange:"Temperature is a compromise â€” not all crops in ideal range",
  noCrops:"No crops selected. Select at least one crop.",
  cropCount:" crops selected",
  wx:[
    {s:"Sunny Â· 33Â°C",d:"Rain 10% Â· Wind 9 km/h Â· UV High",tag:"Heat Stress: Medium",tc:"warning",adv:"Harvest early morning to reduce field heat. Pre-cool produce before storage. Irrigate in the evening."},
    {s:"Partly Cloudy Â· 30Â°C",d:"Rain 30% Â· Wind 12 km/h Â· UV Moderate",tag:"Good for Fieldwork",tc:"ok",adv:"Ideal for harvesting and transport. Apply foliar fertilizers now â€” good absorption weather."},
    {s:"Thunderstorm Likely Â· 28Â°C",d:"Rain 75% Â· Wind 18 km/h Â· UV Low",tag:"Fungal Risk: High",tc:"warning",adv:"Delay spraying â€” rain washes off chemicals. Check drainage. Monitor crops for early blight."},
  ],
  fc:[["Mon","â˜€ï¸","33Â°"],["Tue","â›…","31Â°"],["Wed","ğŸŒ§ï¸","28Â°"],["Thu","â›…","30Â°"],["Fri","â˜€ï¸","32Â°"],["Sat","â˜€ï¸","34Â°"],["Sun","ğŸŒ¦ï¸","29Â°"]],
  al:{
    highTemp:{t:"High Temperature",m:"Internal temp exceeds safe range. Check door and airflow."},
    lowTemp:{t:"Low Temperature",m:"Temp below safe range. Risk of chilling injury."},
    lowBat:{t:"Low Battery",m:"Battery critically low. Switch to Eco mode."},
    doorOpen:{t:"Door Open",m:"Door open. Cooling paused to save energy."},
    modeChanged:{t:"Mode Changed",m:"Operating mode updated."},
    produceChanged:{t:"Produce Updated",m:"Crop profile applied."},
  },
  shelf:{TOMATO:{n:"Tomato",e:"ğŸ…",d:21},ONION:{n:"Onion",e:"ğŸ§…",d:60},POTATO:{n:"Potato",e:"ğŸ¥”",d:90},LEAFY_GREENS:{n:"Leafy Greens",e:"ğŸ¥¬",d:10},CARROT:{n:"Carrot",e:"ğŸ¥•",d:60}},
  prices:[
    {c:"Tomato",e:"ğŸ…",p:"â‚¹45/kg",ch:"+8%",tr:"up",a:"Prices rising â€” hold 2-3 days"},
    {c:"Onion",e:"ğŸ§…",p:"â‚¹32/kg",ch:"-3%",tr:"down",a:"Slight dip â€” sell if stored >30d"},
    {c:"Potato",e:"ğŸ¥”",p:"â‚¹28/kg",ch:"+2%",tr:"up",a:"Stable â€” good time to hold"},
    {c:"Leafy Greens",e:"ğŸ¥¬",p:"â‚¹55/kg",ch:"+12%",tr:"up",a:"High demand â€” sell now"},
    {c:"Carrot",e:"ğŸ¥•",p:"â‚¹38/kg",ch:"0%",tr:"flat",a:"Flat â€” store for recovery"},
  ],
  guides:[
    {e:"ğŸ…",t:"Tomato Storage Guide",d:"Optimal storage for maximum freshness",l:["Store at 10â€“13Â°C (below 10Â°C causes chilling injury)","Keep humidity 85â€“95% to prevent wrinkling","Never store with ethylene-sensitive crops","Sort and remove damaged fruits before storage","Pre-cool within 2 hours of harvest"]},
    {e:"ğŸ§…",t:"Onion Storage Guide",d:"Long-term quality preservation",l:["Cure 2-3 days in warm dry air before cold storage","Store at 2â€“8Â°C with 65â€“75% humidity","Ensure good ventilation â€” onions release moisture","Never store near potatoes","Check weekly for soft or sprouting bulbs"]},
    {e:"ğŸ¥¬",t:"Leafy Greens Guide",d:"Delicate handling, short shelf life",l:["Store immediately at 1â€“5Â°C","Maintain 90â€“98% humidity to prevent wilting","Wash gently, remove excess water","Use perforated bags for airflow","Consume within 7â€“10 days"]},
  ],
  diseases:[
    {n:"Late Blight",c:"Tomato, Potato",r:"high",b:"Dark water-soaked spots on leaves. Spreads fast in humid conditions (>80% RH, 15â€“25Â°C).",a:"Apply copper fungicide immediately. Remove infected plants. Improve spacing for airflow."},
    {n:"Purple Blotch",c:"Onion",r:"medium",b:"Purplish-brown lesions on leaves. Common during high humidity and warm temps.",a:"Apply mancozeb every 10â€“14 days in wet periods. Ensure drainage. Rotate crops."},
    {n:"Aphid Infestation",c:"Leafy Greens, Carrot",r:"medium",b:"Small insects on leaf undersides causing curling and yellowing. Transmit viral diseases.",a:"Spray neem oil (5ml/L) in evening. Use yellow sticky traps. Introduce ladybugs."},
  ],
  seasons:[
    {e:"ğŸ…",n:"Tomato",m:"Oct â€“ Mar",s:true},{e:"ğŸ§…",n:"Onion",m:"Nov â€“ Apr",s:true},
    {e:"ğŸ¥”",n:"Potato",m:"Oct â€“ Feb",s:true},{e:"ğŸ¥¬",n:"Leafy Greens",m:"Sep â€“ Feb",s:true},
    {e:"ğŸ¥•",n:"Carrot",m:"Oct â€“ Feb",s:true},{e:"ğŸŒ½",n:"Corn",m:"Jun â€“ Sep",s:false},
    {e:"ğŸ†",n:"Eggplant",m:"Mar â€“ Jun",s:false},{e:"ğŸŒ¶ï¸",n:"Chili",m:"Feb â€“ Jun",s:false},
  ],
  tips:[
    {e:"ğŸŒ…",t:"Harvest at the Right Time",d:"Harvest early morning when cool. Reduces field heat and extends shelf life up to 40%. Avoid harvesting in rain."},
    {e:"ğŸ“¦",t:"Pre-Cooling is Essential",d:"Remove field heat within 2 hours. Place in shade immediately. Pre-cooled produce lasts 2â€“3Ã— longer."},
    {e:"ğŸ§¹",t:"Hygiene & Sorting",d:"Sort before storage â€” one rotten item spoils the batch. Clean crates between uses."},
    {e:"ğŸ’§",t:"Smart Irrigation",d:"Water deeply but less often. Irrigate early morning. Use mulch to reduce water use by 50%."},
    {e:"ğŸŒ¿",t:"Organic Pest Control",d:"Neem oil for common pests. Companion planting â€” marigolds repel aphids naturally."},
    {e:"ğŸ”„",t:"Crop Rotation",d:"Rotate every season. Follow heavy feeders with light feeders, then legumes to fix nitrogen."},
  ],
  footer:"KisanCool â€” Solar-Powered Smart Cold Storage Â· SDG 2, 7, 12, 13 Â· Hult Prize 2026",
},
ne:{
  navTitle:"à¤•à¤¿à¤¸à¤¾à¤¨à¤•à¥‚à¤²",tagline:"à¤¸à¥à¤®à¤¾à¤°à¥à¤Ÿ à¤•à¥ƒà¤·à¤¿ à¤•à¥‹à¤²à¥à¤¡ à¤¸à¥à¤Ÿà¥‹à¤°à¥‡à¤œ",connected:"à¤œà¤¡à¤¾à¤¨ à¤­à¤¯à¥‹",
  temp:"à¤¤à¤¾à¤ªà¤•à¥à¤°à¤®",hum:"à¤†à¤°à¥à¤¦à¥à¤°à¤¤à¤¾",bat:"à¤¬à¥à¤¯à¤¾à¤Ÿà¥à¤°à¥€",comp:"à¤•à¤®à¥à¤ªà¥à¤°à¥‡à¤¸à¤°",
  normal:"à¤¸à¤¾à¤®à¤¾à¤¨à¥à¤¯",good:"à¤°à¤¾à¤®à¥à¤°à¥‹",low:"à¤•à¤®",critical:"à¤—à¤®à¥à¤­à¥€à¤°",high:"à¤‰à¤šà¥à¤š",
  auto:"à¤¸à¥à¤µà¤šà¤¾à¤²à¤¿à¤¤",on:"à¤šà¤¾à¤²à¥",off:"à¤¬à¤¨à¥à¤¦",tgt:"à¤²à¤•à¥à¤·à¥à¤¯",solar:"à¤¸à¥‹à¤²à¤¾à¤°",
  chartTitle:"ğŸ“ˆ à¤¤à¤¾à¤ªà¤•à¥à¤°à¤® à¤° à¤†à¤°à¥à¤¦à¥à¤°à¤¤à¤¾",shelfTitle:"ğŸ“¦ à¤…à¤¨à¥à¤®à¤¾à¤¨à¤¿à¤¤ à¤­à¤£à¥à¤¡à¤¾à¤°à¤£ à¤…à¤µà¤§à¤¿",
  ctrlTitle:"ğŸ›ï¸ à¤¨à¤¿à¤¯à¤¨à¥à¤¤à¥à¤°à¤£",modeLabel:"à¤¸à¤à¥à¤šà¤¾à¤²à¤¨ à¤®à¥‹à¤¡",produceLabel:"à¤­à¤£à¥à¤¡à¤¾à¤°à¤£à¤®à¤¾ à¤‰à¤¤à¥à¤ªà¤¾à¤¦à¤¨",
  mtLabel:"à¤¤à¤¾à¤ªà¤•à¥à¤°à¤® à¤¸à¥‡à¤Ÿà¤ªà¥‹à¤‡à¤¨à¥à¤Ÿ (Â°C)",mhLabel:"à¤†à¤°à¥à¤¦à¥à¤°à¤¤à¤¾ à¤²à¤•à¥à¤·à¥à¤¯ (%)",
  doorLabel:"à¤¢à¥‹à¤•à¤¾ à¤¸à¥‡à¤¨à¥à¤¸à¤°",doorClosed:"à¤¬à¤¨à¥à¤¦",doorOpen:"à¤–à¥à¤²à¤¾ â€” à¤•à¥‚à¤²à¤¿à¤‚à¤— à¤°à¥‹à¤•à¤¿à¤¯à¥‹",
  gridLabel:"à¤—à¥à¤°à¤¿à¤¡ à¤¬à¤¿à¤œà¥à¤²à¥€",gridOn:"à¤‰à¤ªà¤²à¤¬à¥à¤§",gridOff:"à¤…à¤¨à¥à¤ªà¤²à¤¬à¥à¤§ â€” à¤…à¤«-à¤—à¥à¤°à¤¿à¤¡",
  alertTitle:"ğŸ”” à¤¸à¥‚à¤šà¤¨à¤¾à¤¹à¤°à¥‚",noAlerts:"à¤•à¥à¤¨à¥ˆ à¤¸à¥‚à¤šà¤¨à¤¾ à¤›à¥ˆà¤¨à¥¤ à¤ªà¥à¤°à¤£à¤¾à¤²à¥€ à¤¸à¤¾à¤®à¤¾à¤¨à¥à¤¯ à¤›à¥¤",
  rem:"à¤¬à¤¾à¤à¤•à¥€",days:"à¤¦à¤¿à¤¨",
  unitBadge:"à¤¯à¥à¤¨à¤¿à¤Ÿ #à¥§ â€” à¤¸à¤•à¥à¤°à¤¿à¤¯",mktBadge:"à¤†à¤œ à¤…à¤ªà¤¡à¥‡à¤Ÿ",disBadge:"à¥¨ à¤¸à¤•à¥à¤°à¤¿à¤¯ à¤¸à¥‚à¤šà¤¨à¤¾",
  secMonitor:"â„ï¸ à¤•à¥‹à¤²à¥à¤¡ à¤¸à¥à¤Ÿà¥‹à¤°à¥‡à¤œ à¤…à¤¨à¥à¤—à¤®à¤¨",secWeather:"ğŸŒ¤ï¸ à¤®à¥Œà¤¸à¤® à¤° à¤•à¥ƒà¤·à¤¿ à¤¸à¤²à¥à¤²à¤¾à¤¹",
  secMarket:"ğŸ’° à¤¬à¤œà¤¾à¤° à¤®à¥‚à¤²à¥à¤¯",secGuide:"ğŸŒ¾ à¤¬à¤¾à¤²à¥€ à¤œà¥à¤à¤¾à¤¨ à¤•à¥‡à¤¨à¥à¤¦à¥à¤°",
  secDisease:"ğŸ¦  à¤°à¥‹à¤— à¤° à¤•à¥€à¤°à¤¾ à¤¸à¤¤à¤°à¥à¤•à¤¤à¤¾",secSeason:"ğŸ—“ï¸ à¤®à¥Œà¤¸à¤®à¥€ à¤°à¥‹à¤ªà¤¾à¤‡ à¤ªà¤¾à¤¤à¥à¤°à¥‹",secTips:"ğŸ’¡ à¤¸à¥à¤®à¤¾à¤°à¥à¤Ÿ à¤–à¥‡à¤¤à¥€ à¤¸à¥à¤à¤¾à¤µà¤¹à¤°à¥‚",
  wxLabel:"à¤¹à¤¾à¤²à¤•à¥‹ à¤®à¥Œà¤¸à¤®",fcTitle:"ğŸ“… à¥­ à¤¦à¤¿à¤¨à¤•à¥‹ à¤ªà¥‚à¤°à¥à¤µà¤¾à¤¨à¥à¤®à¤¾à¤¨",
  tabMonitor:"à¤…à¤¨à¥à¤—à¤®à¤¨",tabWeather:"à¤®à¥Œà¤¸à¤®",tabInfo:"à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€",
  selectCrops:"à¤­à¤£à¥à¤¡à¤¾à¤°à¤£à¤®à¤¾ à¤°à¤¹à¥‡à¤•à¥‹ à¤¬à¤¾à¤²à¥€ à¤›à¤¾à¤¨à¥à¤¨à¥à¤¹à¥‹à¤¸à¥",
  TOMATO:"à¤—à¥‹à¤²à¤­à¥‡à¤¡à¤¾",ONION:"à¤ªà¥à¤¯à¤¾à¤œ",POTATO:"à¤†à¤²à¥",LEAFY_GREENS:"à¤¹à¤°à¤¿à¤¯à¥‹ à¤¸à¤¾à¤—à¤ªà¤¾à¤¤",CARROT:"à¤—à¤¾à¤œà¤°",
  idealRange:"à¤¸à¤¬à¥ˆ à¤¬à¤¾à¤²à¥€à¤•à¥‹ à¤‰à¤¤à¥à¤¤à¤® à¤¤à¤¾à¤ªà¤•à¥à¤°à¤® à¤¸à¥€à¤®à¤¾ à¤®à¤¿à¤²à¥à¤›",
  compromiseRange:"à¤¤à¤¾à¤ªà¤•à¥à¤°à¤® à¤¸à¤®à¥à¤à¥Œà¤¤à¤¾ â€” à¤¸à¤¬à¥ˆ à¤¬à¤¾à¤²à¥€à¤•à¥‹ à¤†à¤¦à¤°à¥à¤¶ à¤¸à¥€à¤®à¤¾à¤®à¤¾ à¤›à¥ˆà¤¨",
  noCrops:"à¤•à¥à¤¨à¥ˆ à¤¬à¤¾à¤²à¥€ à¤›à¤¾à¤¨à¤¿à¤à¤•à¥‹ à¤›à¥ˆà¤¨à¥¤ à¤•à¤®à¥à¤¤à¤¿à¤®à¤¾ à¤à¤‰à¤Ÿà¤¾ à¤›à¤¾à¤¨à¥à¤¨à¥à¤¹à¥‹à¤¸à¥à¥¤",
  cropCount:" à¤¬à¤¾à¤²à¥€ à¤›à¤¾à¤¨à¤¿à¤à¤•à¥‹",
  wx:[
    {s:"à¤˜à¤¾à¤® à¤²à¤¾à¤—à¥‡à¤•à¥‹ Â· à¥©à¥©Â°C",d:"à¤µà¤°à¥à¤·à¤¾ à¥§à¥¦% Â· à¤¹à¤¾à¤µà¤¾ à¥¯ km/h Â· UV à¤‰à¤šà¥à¤š",tag:"à¤—à¤°à¥à¤®à¥€ à¤¤à¤¨à¤¾à¤µ: à¤®à¤§à¥à¤¯à¤®",tc:"warning",adv:"à¤¬à¤¿à¤¹à¤¾à¤¨ à¤¸à¤¬à¥‡à¤°à¥ˆ à¤¬à¤¾à¤²à¥€ à¤•à¤¾à¤Ÿà¥à¤¨à¥à¤¹à¥‹à¤¸à¥à¥¤ à¤­à¤£à¥à¤¡à¤¾à¤°à¤£ à¤…à¤˜à¤¿ à¤šà¤¿à¤¸à¥‹ à¤—à¤°à¥à¤¨à¥à¤¹à¥‹à¤¸à¥à¥¤ à¤¸à¤¾à¤à¤à¤®à¤¾ à¤¸à¤¿à¤à¤šà¤¾à¤‡ à¤—à¤°à¥à¤¨à¥à¤¹à¥‹à¤¸à¥à¥¤"},
    {s:"à¤†à¤‚à¤¶à¤¿à¤• à¤¬à¤¾à¤¦à¤² Â· à¥©à¥¦Â°C",d:"à¤µà¤°à¥à¤·à¤¾ à¥©à¥¦% Â· à¤¹à¤¾à¤µà¤¾ à¥§à¥¨ km/h Â· UV à¤®à¤§à¥à¤¯à¤®",tag:"à¤–à¥‡à¤¤à¤•à¥‹ à¤•à¤¾à¤®: à¤ à¥€à¤•",tc:"ok",adv:"à¤¬à¤¾à¤²à¥€ à¤•à¤¾à¤Ÿà¥à¤¨ à¤° à¤¢à¥à¤µà¤¾à¤¨à¥€à¤•à¥‹ à¤²à¤¾à¤—à¤¿ à¤‰à¤¤à¥à¤¤à¤®à¥¤ à¤…à¤¹à¤¿à¤²à¥‡ à¤ªà¤°à¥à¤£à¥€à¤¯ à¤®à¤² à¤ªà¥à¤°à¤¯à¥‹à¤— à¤—à¤°à¥à¤¨à¥à¤¹à¥‹à¤¸à¥à¥¤"},
    {s:"à¤—à¤¡à¤—à¤¡à¤¾à¤¹à¤Ÿ à¤¸à¤®à¥à¤­à¤¾à¤µà¤¿à¤¤ Â· à¥¨à¥®Â°C",d:"à¤µà¤°à¥à¤·à¤¾ à¥­à¥«% Â· à¤¹à¤¾à¤µà¤¾ à¥§à¥® km/h Â· UV à¤•à¤®",tag:"à¤¢à¥à¤¸à¥€ à¤œà¥‹à¤–à¤¿à¤®: à¤‰à¤šà¥à¤š",tc:"warning",adv:"à¤¸à¥à¤ªà¥à¤°à¥‡ à¤¨à¤—à¤°à¥à¤¨à¥à¤¹à¥‹à¤¸à¥ â€” à¤ªà¤¾à¤¨à¥€à¤²à¥‡ à¤§à¥‹à¤‡à¤¦à¤¿à¤¨à¥à¤›à¥¤ à¤¨à¤¿à¤•à¤¾à¤¸à¥€ à¤œà¤¾à¤à¤š à¤—à¤°à¥à¤¨à¥à¤¹à¥‹à¤¸à¥à¥¤ à¤¬à¥à¤²à¤¾à¤‡à¤Ÿ à¤¹à¥‡à¤°à¥à¤¨à¥à¤¹à¥‹à¤¸à¥à¥¤"},
  ],
  fc:[["à¤¸à¥‹à¤®","â˜€ï¸","à¥©à¥©Â°"],["à¤®à¤‚à¤—à¤²","â›…","à¥©à¥§Â°"],["à¤¬à¥à¤§","ğŸŒ§ï¸","à¥¨à¥®Â°"],["à¤¬à¤¿à¤¹à¤¿","â›…","à¥©à¥¦Â°"],["à¤¶à¥à¤•à¥à¤°","â˜€ï¸","à¥©à¥¨Â°"],["à¤¶à¤¨à¤¿","â˜€ï¸","à¥©à¥ªÂ°"],["à¤†à¤‡à¤¤","ğŸŒ¦ï¸","à¥¨à¥¯Â°"]],
  al:{
    highTemp:{t:"à¤‰à¤šà¥à¤š à¤¤à¤¾à¤ªà¤•à¥à¤°à¤®",m:"à¤­à¤¿à¤¤à¥à¤°à¥€ à¤¤à¤¾à¤ªà¤•à¥à¤°à¤® à¤¸à¥à¤°à¤•à¥à¤·à¤¿à¤¤ à¤¸à¥€à¤®à¤¾ à¤­à¤¨à¥à¤¦à¤¾ à¤¬à¤¢à¥€ à¤›à¥¤"},
    lowTemp:{t:"à¤•à¤® à¤¤à¤¾à¤ªà¤•à¥à¤°à¤®",m:"à¤¤à¤¾à¤ªà¤•à¥à¤°à¤® à¤¸à¥à¤°à¤•à¥à¤·à¤¿à¤¤ à¤¸à¥€à¤®à¤¾ à¤­à¤¨à¥à¤¦à¤¾ à¤¤à¤²à¥¤ à¤šà¤¿à¤¸à¥‹ à¤•à¥à¤·à¤¤à¤¿à¤•à¥‹ à¤œà¥‹à¤–à¤¿à¤®à¥¤"},
    lowBat:{t:"à¤•à¤® à¤¬à¥à¤¯à¤¾à¤Ÿà¥à¤°à¥€",m:"à¤¬à¥à¤¯à¤¾à¤Ÿà¥à¤°à¥€ à¤—à¤®à¥à¤­à¥€à¤° à¤°à¥‚à¤ªà¤®à¤¾ à¤•à¤®à¥¤ à¤‡à¤•à¥‹ à¤®à¥‹à¤¡ à¤ªà¥à¤°à¤¯à¥‹à¤— à¤—à¤°à¥à¤¨à¥à¤¹à¥‹à¤¸à¥à¥¤"},
    doorOpen:{t:"à¤¢à¥‹à¤•à¤¾ à¤–à¥à¤²à¤¾",m:"à¤¢à¥‹à¤•à¤¾ à¤–à¥à¤²à¤¾ à¤›à¥¤ à¤Šà¤°à¥à¤œà¤¾ à¤¬à¤šà¤¤ à¤—à¤°à¥à¤¨ à¤•à¥‚à¤²à¤¿à¤‚à¤— à¤°à¥‹à¤•à¤¿à¤¯à¥‹à¥¤"},
    modeChanged:{t:"à¤®à¥‹à¤¡ à¤ªà¤°à¤¿à¤µà¤°à¥à¤¤à¤¨",m:"à¤¸à¤à¥à¤šà¤¾à¤²à¤¨ à¤®à¥‹à¤¡ à¤…à¤¦à¥à¤¯à¤¾à¤µà¤§à¤¿à¤• à¤—à¤°à¤¿à¤¯à¥‹à¥¤"},
    produceChanged:{t:"à¤‰à¤¤à¥à¤ªà¤¾à¤¦à¤¨ à¤…à¤¦à¥à¤¯à¤¾à¤µà¤§à¤¿à¤•",m:"à¤¬à¤¾à¤²à¥€ à¤ªà¥à¤°à¥‹à¤«à¤¾à¤‡à¤² à¤²à¤¾à¤—à¥‚ à¤—à¤°à¤¿à¤¯à¥‹à¥¤"},
  },
  shelf:{TOMATO:{n:"à¤—à¥‹à¤²à¤­à¥‡à¤¡à¤¾",e:"ğŸ…",d:21},ONION:{n:"à¤ªà¥à¤¯à¤¾à¤œ",e:"ğŸ§…",d:60},POTATO:{n:"à¤†à¤²à¥",e:"ğŸ¥”",d:90},LEAFY_GREENS:{n:"à¤¹à¤°à¤¿à¤¯à¥‹ à¤¸à¤¾à¤—à¤ªà¤¾à¤¤",e:"ğŸ¥¬",d:10},CARROT:{n:"à¤—à¤¾à¤œà¤°",e:"ğŸ¥•",d:60}},
  prices:[
    {c:"à¤—à¥‹à¤²à¤­à¥‡à¤¡à¤¾",e:"ğŸ…",p:"â‚¹à¥ªà¥«/à¤•à¥‡.à¤œà¥€.",ch:"+à¥®%",tr:"up",a:"à¤®à¥‚à¤²à¥à¤¯ à¤¬à¤¢à¥à¤¦à¥ˆà¤› â€” à¥¨-à¥© à¤¦à¤¿à¤¨ à¤°à¤¾à¤–à¥à¤¨à¥à¤¹à¥‹à¤¸à¥"},
    {c:"à¤ªà¥à¤¯à¤¾à¤œ",e:"ğŸ§…",p:"â‚¹à¥©à¥¨/à¤•à¥‡.à¤œà¥€.",ch:"-à¥©%",tr:"down",a:"à¤¥à¥‹à¤°à¥ˆ à¤—à¤¿à¤°à¤¾à¤µà¤Ÿ â€” à¥©à¥¦+ à¤¦à¤¿à¤¨ à¤­à¤ à¤¬à¥‡à¤šà¥à¤¨à¥à¤¹à¥‹à¤¸à¥"},
    {c:"à¤†à¤²à¥",e:"ğŸ¥”",p:"â‚¹à¥¨à¥®/à¤•à¥‡.à¤œà¥€.",ch:"+à¥¨%",tr:"up",a:"à¤¸à¥à¤¥à¤¿à¤° â€” à¤­à¤£à¥à¤¡à¤¾à¤°à¤£ à¤—à¤°à¥à¤¨ à¤°à¤¾à¤®à¥à¤°à¥‹"},
    {c:"à¤¸à¤¾à¤—à¤ªà¤¾à¤¤",e:"ğŸ¥¬",p:"â‚¹à¥«à¥«/à¤•à¥‡.à¤œà¥€.",ch:"+à¥§à¥¨%",tr:"up",a:"à¤‰à¤šà¥à¤š à¤®à¤¾à¤— â€” à¤…à¤¹à¤¿à¤²à¥‡ à¤¬à¥‡à¤šà¥à¤¨à¥à¤¹à¥‹à¤¸à¥"},
    {c:"à¤—à¤¾à¤œà¤°",e:"ğŸ¥•",p:"â‚¹à¥©à¥®/à¤•à¥‡.à¤œà¥€.",ch:"à¥¦%",tr:"flat",a:"à¤¸à¤ªà¤¾à¤Ÿ â€” à¤­à¤£à¥à¤¡à¤¾à¤°à¤£ à¤—à¤°à¥à¤¨à¥à¤¹à¥‹à¤¸à¥"},
  ],
  guides:[
    {e:"ğŸ…",t:"à¤—à¥‹à¤²à¤­à¥‡à¤¡à¤¾ à¤­à¤£à¥à¤¡à¤¾à¤°à¤£ à¤—à¤¾à¤‡à¤¡",d:"à¤…à¤§à¤¿à¤•à¤¤à¤® à¤¤à¤¾à¤œà¤—à¥€à¤•à¥‹ à¤²à¤¾à¤—à¤¿ à¤‰à¤¤à¥à¤¤à¤® à¤­à¤£à¥à¤¡à¤¾à¤°à¤£",l:["à¥§à¥¦â€“à¥§à¥©Â°C à¤®à¤¾ à¤­à¤£à¥à¤¡à¤¾à¤°à¤£ (à¥§à¥¦Â°C à¤­à¤¨à¥à¤¦à¤¾ à¤¤à¤² à¤šà¤¿à¤¸à¥‹ à¤•à¥à¤·à¤¤à¤¿)","à¤“à¤‡à¤²à¤¾à¤‰à¤¨ à¤°à¥‹à¤•à¥à¤¨ à¥®à¥«â€“à¥¯à¥«% à¤†à¤°à¥à¤¦à¥à¤°à¤¤à¤¾","à¤‡à¤¥à¤¿à¤²à¥€à¤¨-à¤¸à¤‚à¤µà¥‡à¤¦à¤¨à¤¶à¥€à¤² à¤¬à¤¾à¤²à¥€à¤¸à¤à¤— à¤¨à¤°à¤¾à¤–à¥à¤¨à¥à¤¹à¥‹à¤¸à¥","à¤•à¥à¤·à¤¤à¤¿à¤—à¥à¤°à¤¸à¥à¤¤ à¤«à¤² à¤­à¤£à¥à¤¡à¤¾à¤°à¤£ à¤…à¤˜à¤¿ à¤¹à¤Ÿà¤¾à¤‰à¤¨à¥à¤¹à¥‹à¤¸à¥","à¤•à¤¾à¤Ÿà¥‡à¤•à¥‹ à¥¨ à¤˜à¤£à¥à¤Ÿà¤¾à¤®à¤¾ à¤«à¤¿à¤²à¥à¤¡ à¤¹à¥€à¤Ÿ à¤¹à¤Ÿà¤¾à¤‰à¤¨à¥à¤¹à¥‹à¤¸à¥"]},
    {e:"ğŸ§…",t:"à¤ªà¥à¤¯à¤¾à¤œ à¤­à¤£à¥à¤¡à¤¾à¤°à¤£ à¤—à¤¾à¤‡à¤¡",d:"à¤¦à¥€à¤°à¥à¤˜à¤•à¤¾à¤²à¥€à¤¨ à¤—à¥à¤£à¤¸à¥à¤¤à¤° à¤¸à¤‚à¤°à¤•à¥à¤·à¤£",l:["à¤•à¥‹à¤²à¥à¤¡ à¤¸à¥à¤Ÿà¥‹à¤°à¥‡à¤œ à¤…à¤˜à¤¿ à¥¨-à¥© à¤¦à¤¿à¤¨ à¤¸à¥à¤•à¤¾à¤‰à¤¨à¥à¤¹à¥‹à¤¸à¥","à¥¨â€“à¥®Â°C à¤®à¤¾ à¥¬à¥«â€“à¥­à¥«% à¤†à¤°à¥à¤¦à¥à¤°à¤¤à¤¾à¤®à¤¾ à¤­à¤£à¥à¤¡à¤¾à¤°à¤£","à¤°à¤¾à¤®à¥à¤°à¥‹ à¤¹à¤¾à¤µà¤¾ à¤šà¤²à¤¾à¤šà¤² à¤¸à¥à¤¨à¤¿à¤¶à¥à¤šà¤¿à¤¤ à¤—à¤°à¥à¤¨à¥à¤¹à¥‹à¤¸à¥","à¤†à¤²à¥à¤¸à¤à¤— à¤•à¤¹à¤¿à¤²à¥à¤¯à¥ˆ à¤¨à¤°à¤¾à¤–à¥à¤¨à¥à¤¹à¥‹à¤¸à¥","à¤¹à¤ªà¥à¤¤à¤¾à¤•à¥‹ à¤à¤• à¤ªà¤Ÿà¤• à¤œà¤¾à¤à¤š à¤—à¤°à¥à¤¨à¥à¤¹à¥‹à¤¸à¥"]},
    {e:"ğŸ¥¬",t:"à¤¹à¤°à¤¿à¤¯à¥‹ à¤¸à¤¾à¤—à¤ªà¤¾à¤¤ à¤—à¤¾à¤‡à¤¡",d:"à¤›à¥‹à¤Ÿà¥‹ à¤¶à¥‡à¤²à¥à¤« à¤²à¤¾à¤‡à¤«, à¤¨à¤¾à¤œà¥à¤• à¤¹à¥à¤¯à¤¾à¤¨à¥à¤¡à¤²à¤¿à¤‚à¤—",l:["à¤¤à¥à¤°à¥à¤¨à¥à¤¤à¥ˆ à¥§â€“à¥«Â°C à¤®à¤¾ à¤­à¤£à¥à¤¡à¤¾à¤°à¤£","à¤“à¤‡à¤²à¤¾à¤‰à¤¨ à¤°à¥‹à¤•à¥à¤¨ à¥¯à¥¦â€“à¥¯à¥®% à¤†à¤°à¥à¤¦à¥à¤°à¤¤à¤¾","à¤§à¥‹à¤à¤° à¤…à¤¤à¤¿à¤°à¤¿à¤•à¥à¤¤ à¤ªà¤¾à¤¨à¥€ à¤¹à¤Ÿà¤¾à¤‰à¤¨à¥à¤¹à¥‹à¤¸à¥","à¤ªà¥à¤µà¤¾à¤²à¤¹à¤°à¥‚ à¤­à¤à¤•à¤¾ à¤à¥‹à¤²à¤¾ à¤ªà¥à¤°à¤¯à¥‹à¤— à¤—à¤°à¥à¤¨à¥à¤¹à¥‹à¤¸à¥","à¥­â€“à¥§à¥¦ à¤¦à¤¿à¤¨ à¤­à¤¿à¤¤à¥à¤° à¤–à¤ªà¤¤ à¤—à¤°à¥à¤¨à¥à¤¹à¥‹à¤¸à¥"]},
  ],
  diseases:[
    {n:"à¤¢à¤¿à¤²à¥‹ à¤¬à¥à¤²à¤¾à¤‡à¤Ÿ",c:"à¤—à¥‹à¤²à¤­à¥‡à¤¡à¤¾, à¤†à¤²à¥",r:"high",b:"à¤ªà¤¾à¤¤à¤®à¤¾ à¤—à¤¾à¤¢à¤¾ à¤ªà¤¾à¤¨à¥€ à¤­à¤¿à¤œà¥‡à¤•à¥‹ à¤§à¤¬à¥à¤¬à¤¾à¥¤ à¤†à¤°à¥à¤¦à¥à¤° à¤…à¤µà¤¸à¥à¤¥à¤¾à¤®à¤¾ à¤›à¤¿à¤Ÿà¥‹ à¤«à¥ˆà¤²à¤¿à¤¨à¥à¤›à¥¤",a:"à¤¤à¤¾à¤®à¤¾ à¤†à¤§à¤¾à¤°à¤¿à¤¤ à¤¢à¥à¤¸à¥€à¤¨à¤¾à¤¶à¤• à¤ªà¥à¤°à¤¯à¥‹à¤— à¤—à¤°à¥à¤¨à¥à¤¹à¥‹à¤¸à¥à¥¤ à¤¸à¤‚à¤•à¥à¤°à¤®à¤¿à¤¤ à¤¬à¤¿à¤°à¥à¤µà¤¾ à¤¹à¤Ÿà¤¾à¤‰à¤¨à¥à¤¹à¥‹à¤¸à¥à¥¤ à¤¦à¥‚à¤°à¥€ à¤¬à¤¢à¤¾à¤‰à¤¨à¥à¤¹à¥‹à¤¸à¥à¥¤"},
    {n:"à¤¬à¥ˆà¤œà¤¨à¥€ à¤§à¤¬à¥à¤¬à¤¾",c:"à¤ªà¥à¤¯à¤¾à¤œ",r:"medium",b:"à¤ªà¤¾à¤¤à¤®à¤¾ à¤¬à¥ˆà¤œà¤¨à¥€-à¤–à¥ˆà¤°à¥‹ à¤˜à¤¾à¤‰à¥¤ à¤‰à¤šà¥à¤š à¤†à¤°à¥à¤¦à¥à¤°à¤¤à¤¾ à¤° à¤¨à¥à¤¯à¤¾à¤¨à¥‹ à¤¤à¤¾à¤ªà¤•à¥à¤°à¤®à¤®à¤¾ à¤¸à¤¾à¤®à¤¾à¤¨à¥à¤¯à¥¤",a:"à¤­à¤¿à¤œà¥‡à¤•à¥‹ à¤¸à¤®à¤¯à¤®à¤¾ à¤®à¥à¤¯à¤¾à¤¨à¥à¤•à¥‹à¤œà¥‡à¤¬ à¤ªà¥à¤°à¤¯à¥‹à¤— à¤—à¤°à¥à¤¨à¥à¤¹à¥‹à¤¸à¥à¥¤ à¤¨à¤¿à¤•à¤¾à¤¸à¥€ à¤¸à¥à¤¨à¤¿à¤¶à¥à¤šà¤¿à¤¤ à¤—à¤°à¥à¤¨à¥à¤¹à¥‹à¤¸à¥à¥¤ à¤¬à¤¾à¤²à¥€ à¤šà¤•à¥à¤° à¤—à¤°à¥à¤¨à¥à¤¹à¥‹à¤¸à¥à¥¤"},
    {n:"à¤®à¤¾à¤¹à¥à¤°à¥‹ à¤ªà¥à¤°à¤•à¥‹à¤ª",c:"à¤¸à¤¾à¤—à¤ªà¤¾à¤¤, à¤—à¤¾à¤œà¤°",r:"medium",b:"à¤ªà¤¾à¤¤à¤•à¥‹ à¤ªà¤›à¤¾à¤¡à¤¿ à¤¸à¤¾à¤¨à¤¾ à¤•à¥€à¤°à¤¾à¥¤ à¤•à¥à¤°à¥à¤šà¤¾à¤‰à¤¨à¥‡ à¤° à¤ªà¤¹à¥‡à¤à¤²à¥‹ à¤ªà¤¾à¤°à¥à¤¨à¥‡à¥¤",a:"à¤¸à¤¾à¤à¤à¤®à¤¾ à¤¨à¥€à¤® à¤¤à¥‡à¤² (à¥«ml/L) à¤›à¤°à¥à¤•à¤¨à¥à¤¹à¥‹à¤¸à¥à¥¤ à¤ªà¤¹à¥‡à¤à¤²à¥‹ à¤Ÿà¥à¤°à¥à¤¯à¤¾à¤ªà¤¹à¤°à¥‚ à¤ªà¥à¤°à¤¯à¥‹à¤— à¤—à¤°à¥à¤¨à¥à¤¹à¥‹à¤¸à¥à¥¤"},
  ],
  seasons:[
    {e:"ğŸ…",n:"à¤—à¥‹à¤²à¤­à¥‡à¤¡à¤¾",m:"à¤•à¤¾à¤°à¥à¤¤à¤¿à¤• â€“ à¤šà¥ˆà¤¤",s:true},{e:"ğŸ§…",n:"à¤ªà¥à¤¯à¤¾à¤œ",m:"à¤®à¤‚à¤¸à¤¿à¤° â€“ à¤µà¥ˆà¤¶à¤¾à¤–",s:true},
    {e:"ğŸ¥”",n:"à¤†à¤²à¥",m:"à¤•à¤¾à¤°à¥à¤¤à¤¿à¤• â€“ à¤®à¤¾à¤˜",s:true},{e:"ğŸ¥¬",n:"à¤¸à¤¾à¤—à¤ªà¤¾à¤¤",m:"à¤­à¤¦à¥Œ â€“ à¤®à¤¾à¤˜",s:true},
    {e:"ğŸ¥•",n:"à¤—à¤¾à¤œà¤°",m:"à¤•à¤¾à¤°à¥à¤¤à¤¿à¤• â€“ à¤®à¤¾à¤˜",s:true},{e:"ğŸŒ½",n:"à¤®à¤•à¥ˆ",m:"à¤…à¤¸à¤¾à¤° â€“ à¤­à¤¦à¥Œ",s:false},
    {e:"ğŸ†",n:"à¤­à¤£à¥à¤Ÿà¤¾",m:"à¤šà¥ˆà¤¤ â€“ à¤…à¤¸à¤¾à¤°",s:false},{e:"ğŸŒ¶ï¸",n:"à¤–à¥à¤°à¥à¤¸à¤¾à¤¨à¥€",m:"à¤®à¤¾à¤˜ â€“ à¤…à¤¸à¤¾à¤°",s:false},
  ],
  tips:[
    {e:"ğŸŒ…",t:"à¤¸à¤¹à¥€ à¤¸à¤®à¤¯à¤®à¤¾ à¤¬à¤¾à¤²à¥€ à¤•à¤¾à¤Ÿà¥à¤¨à¥à¤¹à¥‹à¤¸à¥",d:"à¤¬à¤¿à¤¹à¤¾à¤¨ à¤¸à¤¬à¥‡à¤°à¥ˆ à¤šà¤¿à¤¸à¥‹ à¤¹à¥à¤à¤¦à¤¾ à¤•à¤¾à¤Ÿà¥à¤¨à¥à¤¹à¥‹à¤¸à¥à¥¤ à¤¶à¥‡à¤²à¥à¤« à¤²à¤¾à¤‡à¤« à¥ªà¥¦% à¤¸à¤®à¥à¤® à¤¬à¤¢à¥à¤›à¥¤ à¤ªà¤¾à¤¨à¥€à¤®à¤¾ à¤¨à¤•à¤¾à¤Ÿà¥à¤¨à¥à¤¹à¥‹à¤¸à¥à¥¤"},
    {e:"ğŸ“¦",t:"à¤ªà¥à¤°à¤¿-à¤•à¥‚à¤²à¤¿à¤‚à¤— à¤†à¤µà¤¶à¥à¤¯à¤• à¤›",d:"à¥¨ à¤˜à¤£à¥à¤Ÿà¤¾à¤®à¤¾ à¤«à¤¿à¤²à¥à¤¡ à¤¹à¥€à¤Ÿ à¤¹à¤Ÿà¤¾à¤‰à¤¨à¥à¤¹à¥‹à¤¸à¥à¥¤ à¤›à¤¾à¤¯à¤¾à¤à¤®à¤¾ à¤°à¤¾à¤–à¥à¤¨à¥à¤¹à¥‹à¤¸à¥à¥¤ à¤ªà¥à¤°à¤¿-à¤•à¥‚à¤² à¤—à¤°à¥‡à¤•à¥‹ à¥¨â€“à¥©Ã— à¤¬à¤¢à¥€ à¤Ÿà¤¿à¤•à¥à¤›à¥¤"},
    {e:"ğŸ§¹",t:"à¤¸à¤°à¤¸à¤«à¤¾à¤‡ à¤° à¤›à¤¾à¤¨à¤¬à¤¿à¤¨",d:"à¤­à¤£à¥à¤¡à¤¾à¤°à¤£ à¤…à¤˜à¤¿ à¤›à¤¾à¤¨à¥à¤¨à¥à¤¹à¥‹à¤¸à¥ â€” à¤à¤‰à¤Ÿà¤¾ à¤•à¥à¤¹à¤¿à¤à¤•à¥‹à¤²à¥‡ à¤ªà¥‚à¤°à¥ˆ à¤¬à¥à¤¯à¤¾à¤š à¤¬à¤¿à¤—à¤¾à¤°à¥à¤›à¥¤"},
    {e:"ğŸ’§",t:"à¤¸à¥à¤®à¤¾à¤°à¥à¤Ÿ à¤¸à¤¿à¤à¤šà¤¾à¤‡",d:"à¤—à¤¹à¤¿à¤°à¥‹ à¤¤à¤° à¤•à¤® à¤ªà¤Ÿà¤• à¤ªà¤¾à¤¨à¥€à¥¤ à¤¬à¤¿à¤¹à¤¾à¤¨ à¤¸à¤¿à¤à¤šà¤¾à¤‡à¥¤ à¤®à¤²à¥à¤šà¤²à¥‡ à¥«à¥¦% à¤ªà¤¾à¤¨à¥€ à¤¬à¤šà¤¤à¥¤"},
    {e:"ğŸŒ¿",t:"à¤œà¥ˆà¤µà¤¿à¤• à¤•à¥€à¤Ÿ à¤¨à¤¿à¤¯à¤¨à¥à¤¤à¥à¤°à¤£",d:"à¤¨à¥€à¤® à¤¤à¥‡à¤² à¤ªà¥à¤°à¤¯à¥‹à¤— à¤—à¤°à¥à¤¨à¥à¤¹à¥‹à¤¸à¥à¥¤ à¤¸à¤¾à¤¥à¥€ à¤°à¥‹à¤ªà¤¾à¤‡ â€” à¤¸à¤¯à¤ªà¤¤à¥à¤°à¥€à¤²à¥‡ à¤®à¤¾à¤¹à¥à¤°à¥‹ à¤­à¤—à¤¾à¤‰à¤à¤›à¥¤"},
    {e:"ğŸ”„",t:"à¤¬à¤¾à¤²à¥€ à¤šà¤•à¥à¤°",d:"à¤¹à¤°à¥‡à¤• à¤®à¥Œà¤¸à¤® à¤¬à¤¾à¤²à¥€ à¤ªà¤°à¤¿à¤µà¤°à¥à¤¤à¤¨ à¤—à¤°à¥à¤¨à¥à¤¹à¥‹à¤¸à¥à¥¤ à¤­à¤¾à¤°à¥€ à¤«à¤¿à¤¡à¤° à¤ªà¤›à¤¿ à¤¹à¤²à¥à¤•à¤¾ à¤«à¤¿à¤¡à¤°, à¤¤à¥à¤¯à¤¸à¤ªà¤›à¤¿ à¤¦à¤¾à¤²à¤¹à¤°à¥‚à¥¤"},
  ],
  footer:"à¤•à¤¿à¤¸à¤¾à¤¨à¤•à¥‚à¤² â€” à¤¸à¥‹à¤²à¤¾à¤° à¤¸à¥à¤®à¤¾à¤°à¥à¤Ÿ à¤•à¥‹à¤²à¥à¤¡ à¤¸à¥à¤Ÿà¥‹à¤°à¥‡à¤œ Â· SDG 2, 7, 12, 13 Â· Hult Prize 2026",
}};

let lang="ne";
function t(){return L[lang]}

/* â•â•â•â•â•â•â•â•â•â•â•â• Crop Profiles â•â•â•â•â•â•â•â•â•â•â•â• */
const CROPS={
  TOMATO:      {tMin:10,tMax:13, hMin:85,hMax:95, emoji:"ğŸ…"},
  ONION:       {tMin:2, tMax:8,  hMin:65,hMax:75, emoji:"ğŸ§…"},
  POTATO:      {tMin:7, tMax:10, hMin:85,hMax:95, emoji:"ğŸ¥”"},
  LEAFY_GREENS:{tMin:1, tMax:5,  hMin:90,hMax:98, emoji:"ğŸ¥¬"},
  CARROT:      {tMin:0, tMax:2,  hMin:95,hMax:98, emoji:"ğŸ¥•"},
};
const CROP_KEYS=Object.keys(CROPS);

/* â•â•â•â•â•â•â•â•â•â•â•â• State â•â•â•â•â•â•â•â•â•â•â•â• */
const S={
  mode:"AUTO",
  selectedCrops:["TOMATO"],
  doorOpen:false,grid:true,compOn:false,
  bat:84,solar:220,amb:33,temp:11.5,hum:88,
  alerts:[],pts:[],wxIdx:0,
  isCompromise:false,
};

/* â•â•â•â•â•â•â•â•â•â•â•â• Multi-Crop Temperature Logic â•â•â•â•â•â•â•â•â•â•â•â• */
function calcMultiCropTargets(crops){
  if(crops.length===0) return {tMin:4,tMax:8,hMin:80,hMax:95,isCompromise:false};
  if(crops.length===1){const c=CROPS[crops[0]];return{...c,isCompromise:false}}
  // Find intersection of all ranges
  let tMin=Math.max(...crops.map(c=>CROPS[c].tMin));
  let tMax=Math.min(...crops.map(c=>CROPS[c].tMax));
  let hMin=Math.max(...crops.map(c=>CROPS[c].hMin));
  let hMax=Math.min(...crops.map(c=>CROPS[c].hMax));
  let isCompromise=false;
  if(tMin>tMax){
    // No overlap â€” find the compromise midpoint
    isCompromise=true;
    const gapMid=(tMin+tMax)/2;
    tMin=Math.round((gapMid-1)*2)/2;
    tMax=Math.round((gapMid+1)*2)/2;
  }
  if(hMin>hMax){
    isCompromise=true;
    const hMid=(hMin+hMax)/2;
    hMin=Math.round(hMid-5);
    hMax=Math.round(hMid+5);
  }
  hMin=clamp(hMin,50,98);
  hMax=clamp(hMax,hMin,99);
  return{tMin,tMax,hMin,hMax,isCompromise};
}

function tgts(){
  if(S.mode==="MANUAL"){
    const tv=+$("manualTemp").value,hv=+$("manualHum").value;
    return{tMin:tv-1,tMax:tv+1,hMin:hv-5,hMax:hv+5,isCompromise:false};
  }
  const base=calcMultiCropTargets(S.selectedCrops);
  if(S.mode==="ECO")return{...base,tMax:base.tMax+1.5};
  if(S.mode==="PRECOOL")return{...base,tMax:base.tMin+.5};
  return base;
}

/* â•â•â•â•â•â•â•â•â•â•â•â• Crop Chip Selector â•â•â•â•â•â•â•â•â•â•â•â• */
function renderCropChips(){
  const el=$("cropChips");
  let h="";
  for(const key of CROP_KEYS){
    const sel=S.selectedCrops.includes(key);
    h+=`<div class="crop-chip${sel?" selected":""}" data-crop="${key}">
      <span class="chip-check">${sel?"âœ“":""}</span>
      <span class="chip-emoji">${CROPS[key].emoji}</span>
      <span class="chip-name">${t()[key]}</span>
    </div>`;
  }
  el.innerHTML=h;
  // Attach events
  el.querySelectorAll(".crop-chip").forEach(chip=>{
    chip.addEventListener("click",function(){
      const crop=this.dataset.crop;
      const idx=S.selectedCrops.indexOf(crop);
      if(idx>=0){
        if(S.selectedCrops.length>1) S.selectedCrops.splice(idx,1);
        // Don't allow 0 crops selected
      }else{
        S.selectedCrops.push(crop);
      }
      renderCropChips();
      updateCompromiseBanner();
      renderShelf();
      pushA("ok","produceChanged");
    });
  });
  updateProfileHint();
}

function updateProfileHint(){
  const tg=tgts();
  $("profileHint").textContent=tg.tMin+"â€“"+tg.tMax+"Â°C";
}

function updateCompromiseBanner(){
  const tg=calcMultiCropTargets(S.selectedCrops);
  const el=$("compromiseBanner");
  S.isCompromise=tg.isCompromise;
  if(S.selectedCrops.length<=1){el.innerHTML="";return}
  if(tg.isCompromise){
    el.innerHTML=`<div class="compromise-banner compromised"><span class="cb-icon">âš ï¸</span><span>${t().compromiseRange} Â· ${t().tgt}: ${tg.tMin}â€“${tg.tMax}Â°C</span></div>`;
  }else{
    el.innerHTML=`<div class="compromise-banner ideal"><span class="cb-icon">âœ…</span><span>${t().idealRange} Â· ${t().tgt}: ${tg.tMin}â€“${tg.tMax}Â°C</span></div>`;
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â• Alerts â•â•â•â•â•â•â•â•â•â•â•â• */
const aCD=new Map();
function pushA(lv,key){
  const now=Date.now();if(now-(aCD.get(key)||0)<20000)return;aCD.set(key,now);
  const a=t().al[key];if(!a)return;
  S.alerts.unshift({ts:new Date(),lv,key,ti:a.t,msg:a.m});
  S.alerts=S.alerts.slice(0,5);renderAlerts();
}
function renderAlerts(){
  const b=$("alertsBody");$("alertCount").textContent=String(S.alerts.length);
  if(!S.alerts.length){b.innerHTML=`<div class="empty-note">${t().noAlerts}</div>`;return}
  let h="";
  for(const a of S.alerts){
    const ai=t().al[a.key]||{t:a.ti,m:a.msg};
    h+=`<div class="alert-item ${a.lv}"><div class="alert-icon">${a.lv==="ok"?"âœ“":a.lv==="warning"?"!":"Ã—"}</div><div class="alert-text"><div class="ah">${ai.t} <span style="font-weight:400;color:var(--muted);font-size:12px">${a.ts.toLocaleTimeString()}</span></div><div class="ad">${ai.m}</div></div></div>`;
  }
  b.innerHTML=h;
}

/* â•â•â•â•â•â•â•â•â•â•â•â• Static Section Renderers â•â•â•â•â•â•â•â•â•â•â•â• */
function renderPrices(){
  let h="";for(const p of t().prices){
    const cls=p.tr==="up"?"trend-up":p.tr==="down"?"trend-down":"trend-flat";
    const arrow=p.tr==="up"?"â†‘":p.tr==="down"?"â†“":"â†’";
    h+=`<div class="price-card"><div class="pc-emoji">${p.e}</div><div class="pc-info"><div class="pc-name">${p.c}</div><div class="pc-price">${p.p}</div></div><div class="pc-right"><div class="pc-change ${cls}">${arrow} ${p.ch}</div><div class="pc-advice">${p.a}</div></div></div>`;
  }
  $("priceGrid").innerHTML=h;
}
function renderGuides(){
  let h="";for(const g of t().guides){
    let li="";for(const i of g.l)li+=`<li>${i}</li>`;
    h+=`<div class="info-card"><div class="ic-emoji">${g.e}</div><div class="ic-title">${g.t}</div><div class="ic-desc">${g.d}</div><ul class="ic-list">${li}</ul></div>`;
  }
  $("guideGrid").innerHTML=h;
}
function renderDiseases(){
  let h="";for(const d of t().diseases){
    h+=`<div class="disease-card"><div class="d-header"><div class="d-name">${d.n}</div><div class="d-risk ${d.r}">${d.r.toUpperCase()}</div></div><div class="d-crop">${d.c}</div><div class="d-body">${d.b}</div><div class="d-action">âœ… ${d.a}</div></div>`;
  }
  $("diseaseGrid").innerHTML=h;
}
function renderSeasons(){
  let h="";for(const s of t().seasons){
    h+=`<div class="season-item ${s.s?"in-season":"off-season"}"><span class="s-emoji">${s.e}</span><div class="s-name">${s.n}</div><div class="s-months">${s.m}</div></div>`;
  }
  $("seasonGrid").innerHTML=h;
}
function renderTips(){
  let h="";for(const tip of t().tips){
    h+=`<div class="info-card"><div class="ic-emoji">${tip.e}</div><div class="ic-title">${tip.t}</div><div class="ic-desc">${tip.d}</div></div>`;
  }
  $("tipsGrid").innerHTML=h;
}
function renderForecast(){
  let h="";for(const f of t().fc){
    h+=`<div class="forecast-day"><div class="fd-icon">${f[1]}</div><div class="fd-temp">${f[2]}</div><div class="fd-label">${f[0]}</div></div>`;
  }
  $("fcBody").innerHTML=h;
}
function renderWeather(){
  const w=t().wx[S.wxIdx];
  $("wxSummary").textContent=w.s;$("wxDetail").textContent=w.d;
  $("wxTag").textContent=w.tag;$("wxTag").className="tag "+w.tc;
  $("wxAdvice").textContent=w.adv;
}
function renderShelf(){
  if(S.selectedCrops.length===0){
    $("shelfBody").innerHTML=`<div class="empty-note">${t().noCrops}</div>`;return;
  }
  let h="";
  for(const crop of S.selectedCrops){
    const info=t().shelf[crop];if(!info)continue;
    const stored=3;const rem=info.d-stored;
    const pct=clamp(rem/info.d*100,0,100);
    const col=pct>50?"var(--good)":pct>20?"var(--warn)":"var(--bad)";
    h+=`<div class="shelf-item"><span class="shelf-name">${info.e} ${info.n}</span><span class="shelf-days">${rem} ${t().days} ${t().rem}</span><div class="shelf-bar"><div class="fill" style="width:${pct}%;background:${col}"></div></div></div>`;
  }
  $("shelfBody").innerHTML=h;
}

/* â•â•â•â•â•â•â•â•â•â•â•â• Translate All â•â•â•â•â•â•â•â•â•â•â•â• */
function applyLang(){
  const l=t();
  $("navTitle").textContent=l.navTitle;$("navTagline").textContent=l.tagline;
  $("kpiTempLabel").textContent=l.temp;$("kpiHumLabel").textContent=l.hum;
  $("kpiBatLabel").textContent=l.bat;$("kpiCompLabel").textContent=l.comp;
  $("chartTitle").textContent=l.chartTitle;$("shelfTitle").textContent=l.shelfTitle;
  $("ctrlTitle").textContent=l.ctrlTitle;$("modeLabel").textContent=l.modeLabel;
  $("produceLabel").textContent=l.produceLabel;
  $("mtLabel").textContent=l.mtLabel;$("mhLabel").textContent=l.mhLabel;
  $("doorLabel").textContent=l.doorLabel;
  $("doorDesc").textContent=S.doorOpen?l.doorOpen:l.doorClosed;
  $("gridLabel").textContent=l.gridLabel;
  $("gridDesc").textContent=S.grid?l.gridOn:l.gridOff;
  $("alertTitle").textContent=l.alertTitle;
  $("secMonitor").textContent=l.secMonitor;$("unitBadge").textContent=l.unitBadge;
  $("secWeather").textContent=l.secWeather;$("wxLabel").textContent=l.wxLabel;
  $("fcTitle").textContent=l.fcTitle;
  $("secMarket").textContent=l.secMarket;$("mktBadge").textContent=l.mktBadge;
  $("secGuide").textContent=l.secGuide;$("secDisease").textContent=l.secDisease;
  $("disBadge").textContent=l.disBadge;$("secSeason").textContent=l.secSeason;
  $("secTips").textContent=l.secTips;
  $("tabMonitor").textContent=l.tabMonitor;
  $("tabWeather").textContent=l.tabWeather;
  $("tabInfo").textContent=l.tabInfo;
  document.querySelectorAll(".lang-toggle span").forEach(s=>s.classList.toggle("active",s.dataset.lang===lang));
  renderCropChips();updateCompromiseBanner();
  renderAlerts();renderWeather();renderForecast();renderPrices();renderGuides();renderDiseases();renderSeasons();renderTips();renderShelf();
}

/* â•â•â•â•â•â•â•â•â•â•â•â• Chart â•â•â•â•â•â•â•â•â•â•â•â• */
const canvas=$("chart"),ctx=canvas.getContext("2d");
function resizeCanvas(){
  const dpr=devicePixelRatio||1,r=canvas.getBoundingClientRect();
  canvas.width=Math.round(r.width*dpr);canvas.height=Math.round(r.height*dpr);
  ctx.setTransform(dpr,0,0,dpr,0,0);drawChart();
}
window.addEventListener("resize",resizeCanvas);

function drawChart(){
  const w=canvas.getBoundingClientRect().width,h=canvas.getBoundingClientRect().height;
  ctx.clearRect(0,0,w,h);
  ctx.strokeStyle="rgba(0,0,0,.06)";ctx.lineWidth=1;
  for(let i=1;i<5;i++){const y=h/5*i;ctx.beginPath();ctx.moveTo(0,y);ctx.lineTo(w,y);ctx.stroke()}
  const pts=S.pts.slice(-60);
  if(pts.length<2)return;
  const tg=tgts();
  const temps=pts.map(p=>p.t2);
  const tL=Math.min(...temps,0),tH=Math.max(...temps,15);
  const hL=50,hH=98;
  const px=10,py=10;
  const xAt=i=>px+(i/(pts.length-1))*(w-px*2);
  const yT=v=>py+(1-(v-tL)/(tH-tL||1))*(h-py*2);
  const yH=v=>py+(1-(v-hL)/(hH-hL||1))*(h-py*2);
  // target band
  ctx.fillStyle=S.isCompromise?"rgba(217,119,6,.08)":"rgba(37,99,235,.08)";
  const y1=yT(tg.tMax),y2=yT(tg.tMin);
  ctx.fillRect(0,Math.min(y1,y2),w,Math.abs(y2-y1));
  // temp line
  ctx.strokeStyle="#2563eb";ctx.lineWidth=2.5;ctx.lineJoin="round";ctx.beginPath();
  pts.forEach((p,i)=>{const x=xAt(i),y=yT(p.t2);i===0?ctx.moveTo(x,y):ctx.lineTo(x,y)});ctx.stroke();
  // hum line
  ctx.strokeStyle="#059669";ctx.lineWidth=2.5;ctx.beginPath();
  pts.forEach((p,i)=>{const x=xAt(i),y=yH(p.h2);i===0?ctx.moveTo(x,y):ctx.lineTo(x,y)});ctx.stroke();
  // legend
  ctx.font="bold 12px "+getComputedStyle(document.body).fontFamily;
  ctx.fillStyle="#2563eb";ctx.fillText(lang==="ne"?"à¤¤à¤¾à¤ªà¤•à¥à¤°à¤® (Â°C)":"Temp (Â°C)",12,18);
  ctx.fillStyle="#059669";ctx.fillText(lang==="ne"?"à¤†à¤°à¥à¤¦à¥à¤°à¤¤à¤¾ (%)":"Humidity (%)",12,34);
}

/* â•â•â•â•â•â•â•â•â•â•â•â• Simulation Step â•â•â•â•â•â•â•â•â•â•â•â• */
function step(){
  $("clockLabel").textContent=new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});
  const tg=tgts();
  // compressor
  if(S.doorOpen){S.compOn=false}
  else{if(S.temp>tg.tMax+.6)S.compOn=true;if(S.temp<tg.tMin-.6)S.compOn=false}
  // temp dynamics
  let cool=S.compOn?-.18:.06;
  if(S.mode==="ECO"&&S.compOn)cool*=.85;
  if(S.mode==="PRECOOL"&&S.compOn)cool*=1.15;
  if(S.doorOpen)cool=.22;
  const drift=(S.amb-S.temp)*(S.doorOpen?.02:.008);
  S.temp+=drift+cool+rnd(.05);
  // humidity
  const humT=(tg.hMin+tg.hMax)/2;
  S.hum=clamp(S.hum+(humT-S.hum)*.05+rnd(.6)+(S.doorOpen?-.9:0),45,99);
  // battery + solar
  const solarOk=S.solar>120;
  let bd=S.compOn?(solarOk?-.01:-.08):(solarOk?.02:-.01);
  if(!S.grid&&!solarOk)bd-=.03;
  S.bat=clamp(S.bat+bd+rnd(.02),0,100);
  S.solar=clamp(S.solar+rnd(18),0,420);
  const pw=solarOk?t().solar:(S.grid?"Grid":"Battery");
  // alerts
  if(S.temp>tg.tMax+2)pushA("danger","highTemp");
  if(S.temp<tg.tMin-2)pushA("warning","lowTemp");
  if(S.bat<20)pushA("warning","lowBat");
  if(S.doorOpen)pushA("warning","doorOpen");
  // chart point
  S.pts.push({t2:S.temp,h2:S.hum});S.pts=S.pts.slice(-120);
  // KPIs
  $("kpiTemp").textContent=S.temp.toFixed(1)+"Â°C";
  $("kpiTempSub").textContent=`${t().tgt}: ${tg.tMin}â€“${tg.tMax}Â°C`;
  const tOk=S.temp>=tg.tMin-1.5&&S.temp<=tg.tMax+1.5;
  $("kpiTempTag").textContent=tOk?t().normal:(S.temp>tg.tMax?t().high:t().low);
  $("kpiTempTag").className="tag "+(tOk?"ok":(S.temp>tg.tMax+3?"danger":"warning"));

  $("kpiHum").textContent=S.hum.toFixed(0)+"%";
  $("kpiHumSub").textContent=`${t().tgt}: ${tg.hMin}â€“${tg.hMax}%`;
  const hOk=S.hum>=tg.hMin-5&&S.hum<=tg.hMax+5;
  $("kpiHumTag").textContent=hOk?t().normal:(S.hum<tg.hMin?t().low:t().high);
  $("kpiHumTag").className="tag "+(hOk?"ok":"warning");

  $("kpiBat").textContent=S.bat.toFixed(0)+"%";
  $("kpiBatSub").textContent=`${t().solar}: ${Math.round(S.solar)}W Â· ${pw}`;
  $("kpiBatTag").textContent=S.bat>30?t().good:(S.bat>15?t().low:t().critical);
  $("kpiBatTag").className="tag "+(S.bat>30?"ok":(S.bat>15?"warning":"danger"));

  $("kpiComp").textContent=S.compOn?t().on:t().off;
  $("kpiCompSub").textContent=`${t().modeLabel}: ${S.mode}`;
  $("kpiCompTag").textContent=S.mode==="AUTO"?t().auto:S.mode;
  $("kpiCompTag").className="tag ok";

  drawChart();
}

/* â•â•â•â•â•â•â•â•â•â•â•â• Page Navigation â•â•â•â•â•â•â•â•â•â•â•â• */
function switchPage(pageId){
  document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
  $(pageId).classList.add("active");
  document.querySelectorAll(".bottom-nav .tab").forEach(t=>t.classList.toggle("active",t.dataset.page===pageId));
  window.scrollTo({top:0,behavior:"instant"});
  if(pageId==="pageMonitor")resizeCanvas();
}

$("bottomNav").addEventListener("click",function(e){
  const tab=e.target.closest(".tab");
  if(!tab)return;
  switchPage(tab.dataset.page);
});

/* â•â•â•â•â•â•â•â•â•â•â•â• Events â•â•â•â•â•â•â•â•â•â•â•â• */
$("langToggle").addEventListener("click",function(e){
  const sp=e.target.closest("span[data-lang]");
  if(!sp)return;
  lang=sp.dataset.lang;
  applyLang();
});

$("modeSelect").addEventListener("change",function(){
  S.mode=this.value;
  $("modeHint").textContent=S.mode;
  $("manualTempField").style.display=S.mode==="MANUAL"?"block":"none";
  $("manualHumField").style.display=S.mode==="MANUAL"?"block":"none";
  pushA("ok","modeChanged");
  updateProfileHint();
});

$("manualTemp").addEventListener("input",function(){$("mtVal").textContent=Number(this.value).toFixed(1)});
$("manualHum").addEventListener("input",function(){$("mhVal").textContent=this.value});

function togSw(el,on){el.classList.toggle("on",on)}

$("doorSw").addEventListener("click",function(){
  S.doorOpen=!S.doorOpen;
  togSw(this,S.doorOpen);
  $("doorDesc").textContent=S.doorOpen?t().doorOpen:t().doorClosed;
  if(S.doorOpen)pushA("warning","doorOpen");
});

$("gridSw").addEventListener("click",function(){
  S.grid=!S.grid;
  togSw(this,S.grid);
  $("gridDesc").textContent=S.grid?t().gridOn:t().gridOff;
});

/* â•â•â•â•â•â•â•â•â•â•â•â• Init â•â•â•â•â•â•â•â•â•â•â•â• */
function init(){
  // seed chart
  for(let i=0;i<25;i++){
    S.pts.push({t2:S.temp+rnd(.3),h2:S.hum+rnd(1.5)});
  }
  applyLang();
  resizeCanvas();
  // weather rotation
  setInterval(function(){S.wxIdx=(S.wxIdx+1)%t().wx.length;renderWeather()},15000);
  // main loop
  setInterval(step,1000);
  step();
}
init();
</script>
</body>
</html>
